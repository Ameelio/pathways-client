(this["webpackJsonppathways-client"]=this["webpackJsonppathways-client"]||[]).push([[0],{218:function(e,t,n){},219:function(e,t,n){},229:function(e,t,n){},237:function(e,t,n){},294:function(e,t){},297:function(e,t,n){},373:function(e,t,n){"use strict";n.r(t);var r=n(6),a=n(0),c=n.n(a),s=n(26),i=n.n(s),o=(n(218),n(43)),u=(n(219),n(49)),l=n(39),d=n(85),p=n(375),h=n(51),f=function(e){var t="";if(e.isAuthenticated||(t=e.authenticationPath),t){return Object(r.jsx)(h.b,Object(o.a)(Object(o.a)({},e),{},{component:function(){return Object(r.jsx)(h.a,{to:{pathname:t}})},render:void 0}))}return Object(r.jsx)(h.b,Object(o.a)({},e))},j=n(7),b=n.n(j),m=n(18),O=n(42),v=n(378),x=n(379),g=n(380),w=n(382),y=n(94),k=(n(229),n(98)),I=n(181),T=n(50),C=n(67),S=n(64),D=n(120),N=n.n(D),M=Object(S.b)("calls/fetchAll",Object(m.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ge("/calls");case 2:if(200===(t=e.sent).status){e.next=5;break}throw t;case 5:return n=t.data.calls.map((function(e){return N()(e)})),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))),H=Object(S.c)(),A=Object(S.d)({name:"calls",initialState:H.getInitialState(),reducers:{},extraReducers:function(e){e.addCase(M.fulfilled,(function(e,t){return H.setAll(e,t.payload)}))}}),P=(A.actions,n(381)),E=n(383),q=n(95),B=n(57),L=n(208),G=Object(S.b)("connections/fetchAll",Object(m.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ge("/connections");case 2:if(200===(t=e.sent).status){e.next=5;break}throw t;case 5:return n=t.data.connections.map((function(e){return N()(e)})),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))),F=Object(S.c)(),R=Object(S.d)({name:"connection",initialState:F.getInitialState(),reducers:{},extraReducers:function(e){e.addCase(G.fulfilled,(function(e,t){F.setAll(e,t.payload)}))}}),z=(R.actions,H.getSelectors((function(e){return e.calls}))),V=z.selectAll,W=z.selectById,U=F.getSelectors((function(e){return e.connections})),X=U.selectAll,Y=(U.selectById,n(377)),J=n(384);n(237);var _=n(131),K=n(385),Q=n(386),Z=(p.a.Header,p.a.Footer,p.a.Sider),$=p.a.Content,ee=(v.a.Meta,{fetchCalls:M,push:l.e});var te=Object(u.c)((function(e){return{calls:V(e),connections:X(e),name:e.session.user.firstName}}),ee)((function(e){var t,n=e.calls,c=e.connections,s=e.fetchCalls,i=e.push,o=e.name,u=Object(a.useState)([]),l=Object(O.a)(u,2),d=l[0],h=l[1],f=Object(a.useState)((t=Ie)[Math.floor(Math.random()*t.length)]),j=Object(O.a)(f,2),g=j[0];j[1],Object(a.useEffect)((function(){Object(m.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()}),[s]),Object(a.useEffect)((function(){var e=n.filter((function(e){return"scheduled"===e.status||"live"===e.status})).map((function(e){return{call:e,connection:c.find((function(t){return t.id===e.id}))||{user:{firstName:"",lastName:"",profileImgPath:""}}}}));h(e)}),[n,c]);var w=function(e){switch(e.status){case"approved":return"success";case"pending":return"warning";case"rejected":return"danger";default:return"secondary"}};return Object(r.jsxs)(p.a,{style:{minHeight:"100vh"},children:[Object(r.jsxs)($,{children:[Object(r.jsx)(P.a,{title:"Hi ".concat(o,"!")}),Object(r.jsxs)(E.b,{direction:"vertical",size:"large",style:ke,children:[Object(r.jsx)(q.a,{children:Object(r.jsx)(B.a,{span:24,children:Object(r.jsxs)("div",{children:[Object(r.jsxs)(E.b,{direction:"vertical",align:"center",style:{backgroundImage:"url(".concat(g.background,")"),width:"100%"},className:"dashboard-header-container",children:[Object(r.jsx)(x.a.Title,{level:3,className:"dashboard-header-content",children:Object(Y.a)(new Date,"HH:mm")}),Object(r.jsx)(x.a.Title,{level:5,className:"dashboard-header-content",children:g.quote}),Object(r.jsx)(x.a.Text,{className:"dashboard-header-content",children:g.author})]}),Object(r.jsx)("div",{style:{width:"100%",backgroundColor:"white"},children:d.map((function(e){return Object(r.jsx)(v.a,{children:Object(r.jsxs)(E.b,{size:"large",children:[Object(r.jsx)(L.a,{src:e.connection.user.profileImgPath}),Object(r.jsxs)("div",{children:[Object(r.jsxs)(x.a.Title,{level:3,children:["Call with ",e.connection.user.firstName]}),Object(r.jsxs)(x.a.Text,{children:[Object(Y.a)(new Date(e.call.start),"HH:mm")," ","- ",Object(Y.a)(new Date(e.call.end),"HH:mm")," ","| starts in"," ",Object(J.a)(new Date,new Date(e.call.start))," ","minutes"]})]}),Object(r.jsxs)(E.b,{children:[Object(r.jsx)(y.a,{onClick:function(){return i("call/".concat(e.call.id))},children:Object(r.jsx)(_.a,{})}),Object(r.jsx)(y.a,{type:"primary",onClick:function(){return i("call/".concat(e.call.id))},children:"Join"})]})]})})}))})]})})}),Object(r.jsxs)(q.a,{gutter:16,children:[Object(r.jsx)(B.a,{span:12,children:Object(r.jsxs)(v.a,{children:[Object(r.jsx)(K.a,{}),Object(r.jsx)(x.a.Title,{level:4,children:"Schedule Call"})]})}),Object(r.jsx)(B.a,{span:12,children:Object(r.jsxs)(v.a,{children:[Object(r.jsx)(Q.a,{}),Object(r.jsx)(x.a.Title,{level:4,children:"Add Contact"})]})})]})]})]}),Object(r.jsxs)(Z,{theme:"light",width:400,children:[Object(r.jsx)(P.a,{title:"Your Loved Ones"}),c.map((function(e){return Object(r.jsx)(v.a,{children:Object(r.jsx)(v.a.Meta,{title:(t=e.user,t?"".concat(t.firstName," ").concat(t.lastName):""),avatar:Object(r.jsx)(L.a,{src:e.user.profileImgPath}),description:Object(r.jsxs)(x.a.Text,{type:"secondary",children:["Status:"," ",Object(r.jsx)(x.a.Text,{type:w(e),children:e.status})]})})});var t}))]})]})})),ne=n(199),re=n(200),ae="audioType",ce="videoType";window.rc=null,window.consumers=[],window.producers=[];var se={video:{width:{min:640,ideal:1920},height:{min:400,ideal:1080},encodings:[{rid:"r0",maxBitrate:1e5,scalabilityMode:"S1T3"},{rid:"r1",maxBitrate:3e5,scalabilityMode:"S1T3"},{rid:"r2",maxBitrate:9e5,scalabilityMode:"S1T3"}],codecOptions:{videoGoogleStartBitrate:1e3}}},ie=function(){function e(t,n,r){Object(ne.a)(this,e),window.rc=this,this.mediasoupClient=t,this.socket=n,this.callId=r,this.producerTransport=null,this.consumerTransport=null,this.device=null,this.consumers={},this.producers={},this.handlers={consume:[]}}return Object(re.a)(e,[{key:"request",value:function(){var e=Object(m.a)(b.a.mark((function e(t,n){var r=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){r.socket.emit(t,n,(function(t){t.error?a(t.error):e(t)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleTransportConnect",value:function(){var e=Object(m.a)(b.a.mark((function e(t){var n=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){t.on("connect",function(){var r=Object(m.a)(b.a.mark((function r(a,c,s){var i;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=a.dtlsParameters,r.next=3,n.request("establishDtls",{dtlsParameters:i,callId:n.callId,transportId:t.id});case 3:c(),e();case 5:case"end":return r.stop()}}),r)})));return function(e,t,n){return r.apply(this,arguments)}}())})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"init",value:function(){var e=Object(m.a)(b.a.mark((function e(){var t,n,r,a,c=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("join",{callId:this.callId});case 2:return t=e.sent,n=t.producerTransportInfo,r=t.consumerTransportInfo,a=t.routerRtpCapabilities,e.next=8,this.loadDevice(a);case 8:return this.device=e.sent,n&&(this.producerTransport=this.device.createSendTransport(n),this.handleTransportConnect(this.producerTransport)),this.consumerTransport=this.device.createRecvTransport(r),this.handleTransportConnect(this.consumerTransport),e.next=14,this.request("declareRtpCapabilities",{rtpCapabilities:this.device.rtpCapabilities});case 14:this.request("finishConnecting",{callId:this.callId}),this.producerTransport&&this.producerTransport.on("produce",function(){var e=Object(m.a)(b.a.mark((function e(t,n,r){var a,s,i,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.kind,s=t.rtpParameters,e.next=3,c.request("produce",{callId:c.callId,kind:a,rtpParameters:s});case 3:i=e.sent,o=i.producerId,n({id:o});case 6:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),this.socket.on("consume",function(){var e=Object(m.a)(b.a.mark((function e(t){var n,r,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.consume(t);case 2:n=e.sent,r=n.consumer,a=n.stream,c.socket.emit("resumeConsumer",{callId:c.callId,consumerId:r.id}),c.handlers.consume.forEach((function(e){return e(t.kind,a,t.user)}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getMediaConstraints",value:function(e,t){return e===ae?{audio:{deviceId:t}}:e===ce?{video:{width:se.video.width,height:se.video.height,deviceId:t}}:void 0}},{key:"produce",value:function(){var e=Object(m.a)(b.a.mark((function e(t){var n,r,a,c,s,i,o=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:null,r=this.getMediaConstraints(t,n),e.next=4,navigator.mediaDevices.getUserMedia(r);case 4:return a=e.sent,c=(t===ae?a.getAudioTracks():a.getVideoTracks())[0],s={track:c},t===ce&&(s.encodings=se.video.encodings,s.codecOptions=se.video.codecOptions),e.next=10,this.producerTransport.produce(s);case 10:i=e.sent,window.producers.push(i),this.producers[i.id]=i;case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadDevice",value:function(){var e=Object(m.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new this.mediasoupClient.Device,e.next=3,n.load({routerRtpCapabilities:t});case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"consume",value:function(){var e=Object(m.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.consumerTransport.consume(t);case 2:return n=e.sent,r=new MediaStream,this.consumers[n.id]=n,r.addTrack(n.track),e.abrupt("return",{consumer:n,stream:r});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"on",value:function(){var e=Object(m.a)(b.a.mark((function e(t,n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t in this.handlers||(this.handlers[t]=[]),this.handlers[t].push(n);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"terminate",value:function(){var e=Object(m.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("terminate",{callId:this.callId});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),oe=n(201),ue=n(202),le=n.n(ue),de=n(376),pe=(n(297),n(387)),he=n(388),fe=n(389),je=n(390);var be={goBack:l.c},me=Object(u.c)((function(e,t){return{call:W(e,t.match.params.id),authInfo:e.session.authInfo}}),be);function Oe(e){var t=e.message;return Object(r.jsx)("div",{className:"video-loading-spinner",children:Object(r.jsx)(de.a,{tip:t})})}var ve={audio:!1,video:{width:{min:640,ideal:1920},height:{min:400,ideal:1080}}},xe=me(c.a.memo((function(e){var t=e.call,n=e.authInfo,c=e.goBack,s=Object(a.useState)(!1),i=Object(O.a)(s,2),o=i[0],u=i[1],l=Object(a.useState)(),d=Object(O.a)(l,2),p=d[0],h=d[1],f=Object(a.useState)(),j=Object(O.a)(f,2),v=j[0],g=j[1],w=Object(a.useState)(!0),k=Object(O.a)(w,2),I=k[0],T=k[1],C=Object(a.useState)(!1),S=Object(O.a)(C,2),D=S[0],N=S[1],M=function(e){var t=Object(a.useState)(),n=Object(O.a)(t,2),r=n[0],c=n[1];return Object(a.useEffect)((function(){function t(){return(t=Object(m.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.mediaDevices.getUserMedia(e);case 3:n=t.sent,c(n),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}if(r)return function(){r.getTracks().forEach((function(e){e.stop()}))};!function(){t.apply(this,arguments)}()}),[r,e]),r}(ve),H=Object(a.useRef)(null);H.current&&!H.current.srcObject&&M&&(console.log("setting my video"),H.current.srcObject=M),Object(a.useEffect)((function(){if(!v){var e=le.a.connect("".concat("localhost:8000")||!1,{transports:["websocket"]});g(e)}return function(){null===v||void 0===v||v.close()}}),[g,v]);var A=Object(a.useCallback)(Object(m.a)(b.a.mark((function e(){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n=new ie(oe,v,t.id),e.next=5,n.init();case 5:h(n);case 6:case"end":return e.stop()}}),e)}))),[t,v]);Object(a.useEffect)((function(){!o&&v&&t&&Object(m.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(v),v.connected){e.next=7;break}return console.log("Not connected, so waiting until connected."),window.Debug=v,e.next=6,new Promise((function(e){return v.on("connect",e)}));case 6:console.log("OK");case 7:return e.next=9,new Promise((function(e){v.emit("authenticate",{type:n.type,id:n.id,token:n.token},e)}));case 9:return e.next=11,A();case 11:console.log("init room"),u(!0);case 13:case"end":return e.stop()}}),e)})))()}),[t,n,v,A,o]),Object(a.useEffect)((function(){p&&o&&Object(m.a)(b.a.mark((function e(){var t,n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:return t=e.sent,console.log(t),n=Array.from(t).filter((function(e){return"videoinput"===e.kind}))[0],console.log("producing video"),e.next=8,p.produce("videoType",n);case 8:return r=Array.from(t).filter((function(e){return"audioinput"===e.kind}))[0],console.log("producing audio"),e.next=12,p.produce("audioType",r);case 12:case"end":return e.stop()}}),e)})))()}),[o,p]);var P=Object(a.useCallback)((function(e){null!==e&&p&&o&&Object(m.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:p.on("consume",function(){var t=Object(m.a)(b.a.mark((function t(n,r,a){var c,s;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("CONSUME RECEIVED: ".concat(a.type," ").concat(n)),e&&"user"===a.type?(console.log("CONSUME: user stream"),"video"===n?((c=document.createElement("video")).style.width="100%",c.style.height="100%",c.srcObject=r,c.autoplay=!0,e.appendChild(c)):"audio"===n&&((s=document.createElement("audio")).srcObject=r,s.autoplay=!0,e.appendChild(s)),N(!0)):e&&a.type;case 2:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()}),[p,o]);return Object(r.jsxs)("div",{className:"video-wrapper",ref:P,onMouseMove:function(){return function(){var e;T(!0),clearTimeout(e),e=setTimeout((function(){return T(!1)}),5e3)}()},children:[Object(r.jsx)("video",{className:"video-me",autoPlay:!0,ref:H}),!D&&Object(r.jsx)(Oe,{message:o?D?"Loading...":"Waiting for ".concat("Gabe"," to join the call..."):"Initializing video call..."}),I&&Object(r.jsxs)(E.b,{className:"video-overlay-info",children:[Object(r.jsx)(pe.a,{}),Object(r.jsx)(x.a.Title,{level:4,children:Object(Y.a)(new Date,"HH:mm")})]}),I&&Object(r.jsxs)(E.b,{className:"video-overlay-actions",align:"center",children:[Object(r.jsx)(y.a,{shape:"round",icon:Object(r.jsx)(he.a,{}),size:"large"}),Object(r.jsx)(y.a,{shape:"round",icon:Object(r.jsx)(fe.a,{}),size:"large",onClick:function(){return c()}}),Object(r.jsx)(y.a,{shape:"round",icon:Object(r.jsx)(je.a,{}),size:"large"})]})]})}))),ge=-1,we=[{path:"/call/:id",component:xe,label:"Call"},{path:"/",component:te,label:"Dash"}],ye="apiToken",ke={padding:24,paddingTop:0},Ie=[{author:"Mary Ann Evans",quote:"It is never too late to be what you might have been.",description:"",background:"https://images.unsplash.com/photo-1536257104079-aa99c6460a5a?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80"},{author:"Walt Disney",quote:"All our dreams can come true, if we have the courage to pursue them.",description:"",background:"https://images.unsplash.com/photo-1508556497405-ed7dcd94acfc?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80"},{author:"Mark Twain",quote:"The secret of getting ahead is getting started",description:"",background:"https://images.unsplash.com/photo-1532971077387-7c6568101df5?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80"},{author:"Babe Ruth",quote:"It\u2019s hard to beat a person who never gives up.",description:"",background:"https://images.unsplash.com/photo-1564521456797-9f176245daa9?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1951&q=80"}],Te="user/SET_SESSION",Ce="user/LOGOUT",Se=function(e){return{type:Te,payload:e}},De={authInfo:{token:"",id:ge,type:"inmate"},user:{id:ge,firstName:"",lastName:"",email:""},isLoggedIn:!1};function Ne(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:De,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Te:return t.payload;case Ce:return Object(o.a)(Object(o.a)({},e),{},{authInfo:{token:"",id:ge,type:"inmate"},user:{id:ge,firstName:"",lastName:"",email:""},isLoggedIn:!1});default:return e}}var Me,He=Object(C.a)(),Ae=(Me=He,Object(T.c)({session:Ne,calls:A.reducer,connections:R.reducer,router:Object(d.b)(Me)})),Pe=Object(S.a)({reducer:Ae,middleware:function(e){return e().concat(Object(I.a)(He))}}),Ee=n(204),qe=n.n(Ee),Be="".concat("","api/");function Le(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15e3;return Promise.race([fetch(e,Object(o.a)(Object(o.a)({},t),{},{mode:"cors"})),new Promise((function(e,t){return setTimeout((function(){return t(new Error("timeout"))}),n)}))])}function Ge(e){return Fe.apply(this,arguments)}function Fe(){return(Fe=Object(m.a)(b.a.mark((function e(t){var n,r,a,c,s,i,u,l=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>1&&void 0!==l[1]?l[1]:{},a=l.length>2&&void 0!==l[2]?l[2]:15e3,c=Pe.getState(),s=Object(o.a)(Object(o.a)({},r),{},{headers:(n={Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(c.session.authInfo.token)},Object(k.a)(n,"X-Ameelio-User-Type","inmate"),Object(k.a)(n,"X-Ameelio-Inmate-Id","".concat(c.session.authInfo.id)),n)}),e.next=6,Le(qe.a.join(Be,"inmate/".concat(c.session.authInfo.id),t),s,a);case 6:return i=e.sent,e.next=9,i.json();case 9:return u=e.sent,e.abrupt("return",u);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Re=n(205),ze=n.n(Re);function Ve(e){return We.apply(this,arguments)}function We(){return(We=Object(m.a)(b.a.mark((function e(t){var n,r,a,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.data.user,r=t.data.user,a=r.token,c=r.id,Pe.dispatch(Se({user:n,authInfo:{token:a,id:c,type:"inmate"},isLoggedIn:!0})),localStorage.setItem(ye,a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ue(e){return Xe.apply(this,arguments)}function Xe(){return(Xe=Object(m.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Le(ze.a.resolve(Be,"inmate/auth"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({node_id:2,inmate_number:t.inmateNumber,pin:t.pin})});case 2:return n=e.sent,e.next=5,n.json();case 5:if(200===(r=e.sent).status){e.next=8;break}throw r;case 8:return e.next=10,Ve(r);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ye=n(391),Je=n(392),_e=p.a.Content;var Ke=Object(u.c)((function(e){return{session:e.session}}))((function(e){var t=e.session,n=Object(a.useState)(""),c=Object(O.a)(n,2),s=(c[0],c[1]);if(t.isLoggedIn)return Object(r.jsx)(h.a,{to:"/"});var i=function(){var e=Object(m.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ue({inmateNumber:t.inmateNumber,pin:t.pin});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),s("Invalid ID or Pin Code");case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsx)(_e,{children:Object(r.jsxs)(v.a,{className:"login-form-container",children:[Object(r.jsx)(x.a.Title,{level:3,children:"Welcome to Pathways!"}),Object(r.jsxs)(g.a,{name:"basic",onFinish:i,onFinishFailed:function(e){s("Invalid ID or Pin Code")},className:"login-form",children:[Object(r.jsx)(g.a.Item,{name:"inmateNumber",rules:[{required:!0,message:"Inmate ID is required."}],children:Object(r.jsx)(w.a,{prefix:Object(r.jsx)(Ye.a,{className:"site-form-item-icon"}),placeholder:"Inmate Number"})}),Object(r.jsx)(g.a.Item,{name:"pin",rules:[{required:!0,message:"Password is required."}],children:Object(r.jsx)(w.a.Password,{prefix:Object(r.jsx)(Je.a,{className:"site-form-item-icon"}),placeholder:"Pin Code"})}),Object(r.jsx)(g.a.Item,{children:Object(r.jsx)(y.a,{type:"primary",htmlType:"submit",size:"large",block:!0,children:"Log In"})})]})]})})})),Qe=n(153),Ze=n(393),$e=(p.a.Header,p.a.Content,p.a.Footer,p.a.Sider);function et(e){var t=e.navigate,n=e.isVisible,c=e.pathname,s=Object(a.useState)(!1),i=Object(O.a)(s,2),o=i[0],u=i[1];return n&&-1===c.indexOf("call")?Object(r.jsxs)($e,{theme:"light",collapsible:!0,collapsed:o,onCollapse:function(){return u((function(e){return!e}))},children:[Object(r.jsx)("div",{className:"logo"}),Object(r.jsx)(Qe.a,{mode:"inline",defaultSelectedKeys:["home"],children:Object(r.jsx)(Qe.a.Item,{icon:Object(r.jsx)(Ze.a,{}),onClick:function(){return t("home")},children:"Home"},"home")})]}):Object(r.jsx)("div",{})}var tt=p.a.Footer,nt=(p.a.Header,{fetchConnections:G,push:l.e});var rt=Object(u.c)((function(e){return{session:e.session,pathname:e.router.location.pathname}}),nt)((function(e){var t=e.session,n=e.history,c=e.pathname,s=e.fetchConnections,i=e.push,u={isAuthenticated:""!==t.authInfo.token,authenticationPath:"/login"};return Object(a.useEffect)((function(){t.isLoggedIn&&s()}),[t.isLoggedIn]),Object(r.jsx)(d.a,{history:n,children:Object(r.jsxs)(p.a,{style:{minHeight:"100vh"},children:[Object(r.jsx)(et,{navigate:function(e){return i(e)},isVisible:t.isLoggedIn,pathname:c}),Object(r.jsxs)(p.a,{children:[Object(r.jsxs)(h.d,{children:[Object(r.jsx)(h.b,{exact:!0,path:"/login",component:Ke}),we.map((function(e){return Object(a.createElement)(f,Object(o.a)(Object(o.a)({exact:!0},u),{},{path:e.path,component:e.component,key:e.label}))}))]}),Object(r.jsx)(tt,{style:{textAlign:"center"},children:"Connect \xa92021 Created by Ameelio Inc."})]})]})})})),at=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,394)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};i.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(u.a,{store:Pe,children:Object(r.jsx)(rt,{history:He})})}),document.getElementById("root")),at()}},[[373,1,2]]]);
//# sourceMappingURL=main.1a0d01ca.chunk.js.map